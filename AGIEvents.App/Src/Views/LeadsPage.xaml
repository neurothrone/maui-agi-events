<?xml version="1.0" encoding="utf-8"?>

<ContentPage
    Title="Leads"
    x:Class="AGIEvents.App.Views.LeadsPage"
    x:DataType="viewModel:LeadsViewModel"
    x:Name="Page"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:viewModel="clr-namespace:AGIEvents.App.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Share"
                     IconImageSource="icon_share.png"
                     Command="{Binding ExportLeadsCommand}" />
        <!-- <ToolbarItem Text="Add" IconImageSource="{FontImage Glyph='+', Color=White, Size=22}" -->
        <!--              Command="{Binding  NewCommand}" /> -->
    </ContentPage.ToolbarItems>

    <Grid RowDefinitions="auto,auto,*"
          RowSpacing="10"
          Margin="10">

        <Image Grid.Row="0"
               x:Name="EventImage"
               Source="{Binding Image}"
               HeightRequest="75" />

        <VerticalStackLayout Grid.Row="1">
            <FlexLayout Direction="Row"
                        JustifyContent="End"
                        AlignContent="End">
                <Label FlexLayout.Grow="1"
                       VerticalOptions="End"
                       Text="Your leads"
                       TextColor="White"
                       FontSize="24"
                       FontAttributes="Bold" />

                <Button VerticalOptions="Start"
                        ImageSource="icon_qrcode.png"
                        HeightRequest="20"
                        WidthRequest="20"
                        TextColor="White"
                        BackgroundColor="SlateBlue"
                        FontSize="24"
                        FontAttributes="Bold"
                        Padding="0"
                        Margin="0,0,5,0"
                        SemanticProperties.Description="Add Lead through QR Code Scanner"
                        Command="{Binding NavigateToAddLeadCommand}" />

                <Button Text="+"
                        VerticalOptions="Start"
                        WidthRequest="20"
                        HeightRequest="20"
                        TextColor="White"
                        BackgroundColor="SlateBlue"
                        FontSize="24"
                        FontAttributes="Bold"
                        Padding="0"
                        SemanticProperties.Description="Add Lead manually through a form"
                        Command="{Binding NavigateToAddLeadCommand}" />
            </FlexLayout>

            <BoxView Margin="0,10,0,0"
                     HeightRequest="1"
                     Color="SlateBlue" />
        </VerticalStackLayout>

        <CollectionView Grid.Row="2"
                        ItemsSource="{Binding Leads}"
                        VerticalScrollBarVisibility="{OnIdiom Desktop=Always, Default=Never}">

            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical"
                                   ItemSpacing="10" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="viewModel:LeadViewModel">
                    <Grid ColumnDefinitions="*,auto"
                          RowDefinitions="*,*, auto"
                          RowSpacing="5">

                        <HorizontalStackLayout Grid.Column="0"
                                               Grid.Row="0"
                                               Spacing="10">
                            <Image Source="icon_person.png"
                                   WidthRequest="15"
                                   HeightRequest="15" />
                            <Label Text="{Binding FullName}" />
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Grid.Column="0"
                                               Grid.Row="1"
                                               Spacing="10">
                            <Image Source="icon_company.png"
                                   WidthRequest="15"
                                   HeightRequest="15" />
                            <Label Text="{Binding Company}" />
                        </HorizontalStackLayout>

                        <ImageButton Grid.Column="1"
                                     Grid.RowSpan="2"
                                     Source="icon_chevron_right.png"
                                     Scale="0.3" />

                        <BoxView Grid.ColumnSpan="2"
                                 Grid.Row="2"
                                 Color="Silver"
                                 HeightRequest="0.5"
                                 Margin="0, 10" />

                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>